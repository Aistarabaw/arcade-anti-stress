<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zen Clicker ‚Äî Arcade Anti‚ÄëStress</title>
  <meta name="description" content="Clica no ritmo certo para manter a calma. Clicker minimal e zen." />
  <style>
    :root{
      --bg1:#eef2ff; --bg2:#f8fafc; --ink:#0f172a; --muted:#64748b; --brand:#6366f1; --stroke: rgba(255,255,255,.7);
      --card: rgba(255,255,255,.6); --shadow: 0 10px 30px rgba(2,6,23,.08);
    }
    @media (prefers-color-scheme: dark){
      :root{ --bg1:#0b1220; --bg2:#0a0f1a; --ink:#e5e7eb; --muted:#94a3b8; --brand:#8b5cf6; --stroke: rgba(255,255,255,.12); --card: rgba(15,23,42,.5); --shadow: 0 12px 36px rgba(0,0,0,.35); }
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0; font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink); background: radial-gradient(1200px 800px at 30% -10%, var(--bg1), var(--bg2)) fixed;
      display:grid; grid-template-rows:auto 1fr auto; min-height:100%;}
    header{display:flex; justify-content:space-between; align-items:center; gap:12px; padding:12px 16px; position:sticky; top:0; z-index:10;
      backdrop-filter: saturate(120%) blur(8px); background: linear-gradient(to bottom, rgba(255,255,255,.4), transparent); border-bottom:1px solid var(--stroke)}
    .brand{display:flex; gap:10px; align-items:center; font-weight:800}
    main{display:grid; place-items:center; padding:16px}
    .wrap{width:min(900px,96vw); display:grid; gap:16px}
    .panel{padding:14px; border-radius:18px; background:var(--card); border:1px solid var(--stroke); box-shadow: var(--shadow);}
    .controls{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    .pill{appearance:none; border:1px solid var(--stroke); background:rgba(255,255,255,.55); padding:10px 14px; border-radius:999px; cursor:pointer; font-weight:700}
    .pill[aria-pressed="true"]{outline:3px solid rgba(99,102,241,.18)}
    .arena{position:relative; height:420px; border-radius:14px; border:1px dashed var(--stroke); display:grid; place-items:center; overflow:hidden}
    canvas{width:100%; height:420px;}
    .hud{display:flex; gap:12px; justify-content:space-between; align-items:center; color:var(--muted); font-weight:700}
    .big{font-size:28px; font-weight:900}
    footer{padding:14px 16px; color:var(--muted); text-align:center; font-size:13px}
  </style>
</head>
<body>
  <header>
    <div class="brand"><span>üßò</span><span>Zen Clicker</span></div>
    <nav class="controls">
      <button id="start" class="pill">‚ñ∂Ô∏è Iniciar</button>
      <button id="pause" class="pill">‚è∏Ô∏è Pausa</button>
      <button id="reset" class="pill">üîÑ Reiniciar</button>
      <button id="sound" class="pill">üîà Som</button>
      <button id="slow" class="pill">üåø Modo Lento</button>
    </nav>
  </header>
  <main>
    <div class="wrap">
      <section class="panel arena">
        <canvas id="cv"></canvas>
        <div class="hud" style="position:absolute; inset:12px;">
          <div>Pontua√ß√£o: <b id="score">0</b> ‚Ä¢ S√©rie: <b id="streak">0</b></div>
          <div class="big" id="hint">Clica no alvo</div>
          <div><b id="bpm">72</b> bpm</div>
        </div>
      </section>
      <section class="panel">
        <b>Como jogar</b>
        <p>Uma <b>barra</b> desliza suavemente para cima e para baixo. Tenta <b>clicar</b> (ou carregar na barra de espa√ßo) quando a barra estiver dentro da <b>zona alvo</b> semi-transparente. Segue o ritmo ‚Äî quanto mais consistente, maior a s√©rie e a calma.</p>
      </section>
    </div>
  </main>
  <footer>Respira no ritmo. Se quiseres, ativa o modo lento para um andamento mais tranquilo.</footer>

  <script>
    const cv = document.getElementById('cv'); const ctx = cv.getContext('2d');
    function resize(){ cv.width = cv.clientWidth * Math.min(2, devicePixelRatio||1); cv.height = cv.clientHeight * Math.min(2, devicePixelRatio||1); }
    resize(); new ResizeObserver(resize).observe(cv);

    let running=false, paused=false, slow=false, soundOn=false;
    let t=0; let bpm = 72; // ritmo base
    let score=0, streak=0;

    const scoreEl = document.getElementById('score');
    const streakEl = document.getElementById('streak');
    const bpmEl = document.getElementById('bpm');
    const hintEl = document.getElementById('hint');

    let audioCtx;
    function clickSound(ok=true){
      if(!soundOn) return; audioCtx = audioCtx || new (window.AudioContext||window.webkitAudioContext)();
      const o=audioCtx.createOscillator(), g=audioCtx.createGain();
      o.type='sine'; o.frequency.value = ok? 520: 220;
      g.gain.value=0.0001; g.gain.exponentialRampToValueAtTime(ok?0.07:0.05, audioCtx.currentTime+0.01);
      g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime+0.15);
      o.connect(g).connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+0.16);
    }

    function draw(y, targetTop, targetBottom){
      const w=cv.width, h=cv.height; ctx.clearRect(0,0,w,h);
      // zona alvo
      ctx.fillStyle='rgba(255,255,255,.18)'; ctx.fillRect(w*0.1, targetTop, w*0.8, targetBottom-targetTop);
      ctx.strokeStyle='rgba(255,255,255,.7)'; ctx.lineWidth=2; ctx.strokeRect(w*0.1, targetTop, w*0.8, targetBottom-targetTop);
      // barra
      ctx.fillStyle='rgba(255,255,255,.85)'; ctx.fillRect(w*0.1, y-6, w*0.8, 12);
    }

    function targetZone(h){
      const zoneH = h * 0.18;
      const center = h * (0.5 + 0.25*Math.sin(t*0.12));
      return [center - zoneH/2, center + zoneH/2];
    }

    function loop(){
      if(!running || paused) return;
      const w=cv.width, h=cv.height;
      const speed = (slow? 0.8:1) * (bpm/60) * Math.PI; // rela√ß√£o com bpm
      t += 1/60;
      const y = h*(0.2 + 0.6*(0.5+0.5*Math.sin(t*speed)));
      const [top, bottom] = targetZone(h);
      draw(y, top, bottom);
      requestAnimationFrame(loop);
    }

    function judge(){
      const h=cv.height;
      const speed = (slow? 0.8:1) * (bpm/60) * Math.PI;
      const y = h*(0.2 + 0.6*(0.5+0.5*Math.sin(t*speed)));
      const [top, bottom] = targetZone(h);
      const ok = y>=top && y<=bottom;
      if(ok){ score += 10 + Math.floor(streak*0.5); streak++; hintEl.textContent = 'Perfeito ‚ú®'; }
      else { streak = 0; score = Math.max(0, score-3); hintEl.textContent = 'Tenta alinhar com a zona'; }
      scoreEl.textContent = score; streakEl.textContent = streak; clickSound(ok);
      if(navigator.vibrate) navigator.vibrate(ok? 10: 30);
    }

    // Controles
    document.getElementById('start').addEventListener('click', ()=>{ if(!running){ running=true; paused=false; loop(); }});
    document.getElementById('pause').addEventListener('click', ()=>{ paused=!paused; if(!paused) loop(); });
    document.getElementById('reset').addEventListener('click', ()=>{ score=0; streak=0; scoreEl.textContent=0; streakEl.textContent=0; t=0; hintEl.textContent='Clica no alvo'; });
    document.getElementById('sound').addEventListener('click', (e)=>{ soundOn=!soundOn; e.currentTarget.textContent = soundOn? 'üîä Som':'üîà Som'; if(soundOn) clickSound(true); });
    document.getElementById('slow').addEventListener('click', (e)=>{ slow=!slow; e.currentTarget.setAttribute('aria-pressed', String(slow)); });

    // Espa√ßo para julgar
    document.addEventListener('keydown', (e)=>{ if(e.key===' ') { e.preventDefault(); judge(); }});
    cv.addEventListener('pointerdown', judge);
  </script>
</body>
</html>
